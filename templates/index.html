<!DOCTYPE html>
<html>
  <head>
    <title>Weightlifting Result</title>
  </head>
  <body>
    <div class="container">
      <h1>Search Weightlifting Meet Result</h1>
      <form role="form" method='POST' action='/'>
        <div class="form-group">
          <p>Filtering Options</p>
<!--          All filtering info MUST be drop down menu-->
          <input type="text" id="fname" name="fname" placeholder="First Name" value="{{ fname }}">
          <input type="text" id="lname" name="lname" placeholder="Last Name" value="{{ lname }}">

          <select id="gender" name="gender">
            <option value="" {% if gender_select=="" %} selected {% endif %}>Select Gender</option>
            <option value="m" {% if gender_select=="m" %} selected {% endif %}>Male</option>
            <option value="w" {% if gender_select=="w" %} selected {% endif %}>Female</option>
          </select>

          <select id="nation" name="nation">
            <option value="" {% if nation_select=="" %} selected {% endif %}>Select Nation</option>
            {% for nation in nations %}
              <option value="{{ nation }}" {% if nation_select==nation %} selected {% endif %}>{{ nation }}</option>
            {% endfor %}
          </select>

          <select id="weight_class" name="weight_class">
            <option value="" {% if weight_class_select=="" %} selected {% endif %}>Select Weight Class</option>
            {% for weight_class in weight_classes %}
              <option value="{{ weight_class }}" {% if weight_class_select==weight_class %} selected {% endif %}>{{ weight_class }}</option>
            {% endfor %}
          </select>

          <select id="meet" name="meet">
            <option value="" {% if meet_select=="" %} selected {% endif %}>Select Meet</option>
            {% for meet in meets %}
              <option value="{{ meet }}" {% if meet_select==meet %} selected {% endif %}>{{ meet }}</option>
            {% endfor %}
          </select>
        </div>
        <button type="submit" class="btn btn-default">Submit</button>
      </form>
      <br>
      {% for result in results %}
        <h4>{{ result.name, result.nation, result.weight_class, result.gender }}</h4>
      {% endfor %}
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script type=text/javascript>
      // Learned from here https://flask.palletsprojects.com/en/1.0.x/patterns/jquery/
      $(function() {
        $('#gender').change(function() {
          $.getJSON(
            '/weight_class',                // backend url to call
            {gender: $('#gender').val()},   // data to be passed to the backend url
            function(data) {                // after backend returns processed data back, handle new data
              // Remove old options
              $('#weight_class').find('option').remove();
              // Add new items
              $('#weight_class').append('<option value="">Select Weight Class</option>')
              for (val of data){
                $('#weight_class').append('<option value="' + val + '">' + val + '</option>')
              }
            }
          );
        });
      });
    </script>
  </body>
</html>